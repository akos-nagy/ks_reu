\documentclass[reqno,10pt]{amsart}

%%%%%%%%%% Packages %%%%%%%%%%

\usepackage{amsmath,amssymb,mathtools,verbatim,bbm}%,kpfonts}
\usepackage[widespace,upright]{fourier}
\usepackage[backrefs]{amsrefs}
\usepackage[protrusion=true]{microtype}
\usepackage[english]{babel}
\usepackage[margin=1in]{geometry}
\usepackage[onehalfspacing]{setspace}
\usepackage[pdfusetitle,colorlinks,pagebackref,hypertexnames=false,bookmarks=false]{hyperref}
\numberwithin{equation}{section}						% must call it before cleveref
\usepackage[nameinlink,noabbrev]{cleveref}
\expandafter\def\csname ver@etex.sty\endcsname{3000/12/31}
\let\globcount\newcount
\usepackage{autonum}									% must call after cleveref

%%%%%%%%%% align break fix %%%%%%%%%%

\allowdisplaybreaks

%%%%%%%%%% Left/Right fix %%%%%%%%%%

\let\originalleft\left
\let\originalright\right
\renewcommand{\left}{\mathopen{}\mathclose\bgroup\originalleft}
\renewcommand{\right}{\aftergroup\egroup\originalright}

%%%%%%%%%% eqref fix %%%%%%%%%%

\makeatletter
\renewcommand*{\eqref}[1]{\hyperref[{#1}]{\textup{\tagform@{\ref*{#1}}}}}
\makeatother

%%%%%%%%%% oxford comma fix %%%%%%%%%%

\newcommand{\creflastconjunction}{, and\nobreakspace}

%%%%%%%%%% eqdef fix %%%%%%%%%%

\newcommand{\eqdef}{\mathrel{\vcenter{\baselineskip0.5ex\lineskiplimit0pt\hbox{.}\hbox{.}}}=}

%%%%%%%%%% Theorems/numbering %%%%%%%%%%

\newtheorem{theorem}{Theorem}[section]
\newtheorem{Mtheorem}{Main Theorem}
\newtheorem*{acknowledgment}{Acknowledgment}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{condition}[theorem]{Condition}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{hypoth}[theorem]{Hypothesis}
\crefname{theorem}{Theorem}{Theorems}						% label for Theorems
\creflabelformat{theorem}{#2{#1}#3}							% label format for 'theorem'
\crefname{Mtheorem}{Main Theorem}{Main Theorems}			% label for the Main Theorems
\creflabelformat{Mtheorem}{#2{#1}#3}						% label format for 'Mtheorem'
\crefname{lemma}{Lemma}{Lemmata}							% label for Lemmata
\creflabelformat{lemma}{#2{#1}#3}							% label format for 'lemma'
\crefname{corollary}{Corollary}{Corollaries}				% label for Corollaries
\creflabelformat{corollary}{#2{#1}#3}						% label format for 'corollary'
\crefname{proposition}{Proposition}{Propositions}			% label for Propositions
\creflabelformat{proposition}{#2{#1}#3}						% label format for 'proposition'
\crefname{ineq}{inequality}{inequalities}					% label for inequalities
\creflabelformat{ineq}{#2{\upshape(#1)}#3}					% label format for 'ineq'
\crefname{cond}{condition}{conditions}						% label for conditions
\creflabelformat{cond}{#2{\upshape(#1)}#3}					% label format for 'cond'
\crefname{hypoth}{Hypothesis}{Hypotheses}					% label for Hypotheses
\creflabelformat{hypoth}{#2{#1}#3}							% label format for 'hypoth'
\crefname{definition}{Definition}{Definitions}						% label for Definitions
\creflabelformat{def}{#2{#1}#3}								% label format for 'def'
\crefname{appsec}{Appendix}{Appendices}

%%%%%%%%%% Blackboard %%%%%%%%%%

\def\id{\mathbbm{1}}
\def\cx{\mathbb{C}}
\def\rl{\mathbb{R}}
\def\N{\mathbb{N}}
\def\P{\mathbb{P}}
\def\Z{\mathbb{Z}}

%%%%%%%%%% CalligraPhics %%%%%%%%%%

\def\cA{\mathcal{A}}
\def\cB{\mathcal{B}}
\def\cC{\mathcal{C}}
\def\cD{\mathcal{D}}
\def\cE{\mathcal{E}}
\def\cF{\mathcal{F}}
\def\cG{\mathcal{G}}
\def\cH{\mathcal{H}}
\def\cI{\mathcal{I}}
\def\cJ{\mathcal{J}}
\def\cK{\mathcal{K}}
\def\cL{\mathcal{L}}
\def\cM{\mathcal{M}}
\def\cN{\mathcal{N}}
\def\cO{\mathcal{O}}
\def\cP{\mathcal{P}}
\def\cQ{\mathcal{Q}}
\def\cR{\mathcal{R}}
\def\cS{\mathcal{S}}
\def\cT{\mathcal{T}}
\def\cU{\mathcal{U}}
\def\cV{\mathcal{V}}
\def\cW{\mathcal{W}}
\def\cZ{\mathcal{Z}}

%%%%%%%%%% Romans %%%%%%%%%%

\def\Ar{\mathrm{Area}}
\def\dist{\mathrm{dist}}
\def\Im{\mathrm{Im}}
\def\image{\mathrm{image}}
\def\Re{\mathrm{Re}}
\def\sign{\textsc{sign}}
\def\Spec{\mathrm{Spec}}
\def\supp{\mathrm{supp}}
\def\tr{\mathrm{tr}}

%%%%%%%%%% Other symbols (paper specific) %%%%%%%%%%

\def\del{\partial}
\def\delbar{\overline{\partial}}
\def\rd{\operatorname{d\!}{}}

%%%%%%%%%% Other formatting %%%%%%%%%%

\title{The Keller--Segel equation compact surfaces}
\date{\today}
\keywords{Keller--Segel equations}
%\subjclass[2010]{}

%\author{}
%\address[]{}
%\urladdr{\href{}{}}
%\email{\href{}{}}

\calclayout
\pagestyle{plain}
\clubpenalty = 10000
\widowpenalty = 10000
\setlength{\footskip}{20pt}

\hypersetup{
	unicode			= true,
	pdffitwindow	= true,
	pdftoolbar		= false,
	pdfmenubar		= false,
	pdfstartview	= {FitH},
	hypertexnames	= false,
	colorlinks		= true,
	linkcolor		= black,
	citecolor		= black,
	filecolor		= black,
	urlcolor		= blue
}

\newcommand{\ul}{\underline l}
\newcommand{\uk}{\underline k}
\newcommand{\uj}{\underline j}

\begin{document}

\vspace*{-1in}

\section{general discussion}

Let $\Sigma$ be any smooth, compact surface (potentially with boundary), and let $\Delta$ be its Laplace operators. Let $\left( f_a \in L^2 (\Sigma) \right)_{a \in I}$ be a complete, orthonormal set of eigenfunctions (thus $I$ is countable infinite), that is $\Delta f_a = \lambda_a f_a$. Without any loss of generality, assume that $0 \in I$ and $f_0$ is a constant. Then write
\begin{equation}
	\varrho_t = \sum\limits_{a \in I} \sum\limits_{n \in \N} R_{n, a} t^n f_a.
\end{equation}
Let
\begin{equation}
	\varphi_{a, b, c} \eqdef \int\limits_\Sigma f_a f_b f_c \mathrm{d} A.
\end{equation}

If $\varrho_t$ solves the Keller--Segel equation, then and $a \neq 0$, then
\begin{equation}
	R_{n + 1, a} = \frac{R_{0, 0} - \lambda_a}{n + 1} R_{n, a} + \sum\limits_{b, c \in I - \{ 0 \}} \sum\limits_{m = 0}^n \frac{\lambda_a - \lambda_b + \lambda_c}{(n + 1) \lambda_c} \varphi_{a, b, c} R_{b, m} R_{c, n - m}. \label{eq:general_iteration_0}
\end{equation}

\begin{remark}
	For all $\Lambda \in \rl_+$, let
	\begin{equation}
		n (\Lambda) \eqdef \left| \left\{ \ a \in I \ \middle| \ \lambda_a \leqslant \Lambda \ \right\} \right|.
	\end{equation}
	Weyl's law, that states that
	\begin{equation}
		\lim\limits_{\Lambda \rightarrow \infty} \frac{\Lambda}{n (\Lambda)} = \frac{2}{\Ar \left( \Sigma, g \right)}.
	\end{equation}
\end{remark}

\section{convergence of the iterative method on the standard torus}

Let us write
\begin{equation}
	\varrho (x, t) = \sum\limits_{\underline{k} \in \Z^2} \sum\limits_{n \in \N} R_{n, \underline{k}} t^n \exp \left( 2 \pi i \underline{k} \cdot \underline{x} \right).
\end{equation}
If $\varrho$ solves the Keller--Segel equation, then and $\underline{k} \neq \underline{0}$, then
\begin{equation}
	R_{n + 1, \underline{k}} = \tfrac{R_{0, \underline{0}} - 4 \pi^2 \left| \underline{k} \right|^2}{n + 1} R_{n, \underline{k}} + \sum\limits_{\underline{l} \in \Z^2 - \left\{ \underline{0}, \underline{k} \right\}} \tfrac{\underline{k} \cdot \underline{l}}{\left| \underline{l} \right|^2} \sum\limits_{m = 0}^n \tfrac{1}{n + 1} R_{m, \underline{l}} R_{n - m, \underline{k} - \underline{l}}. \label{eq:iteration_torus}
\end{equation}

Finally let
\begin{equation}
	\forall \underline{k} \in \Z^2 : \quad S_{\underline{k}} (t) \eqdef R_{\underline{k}} (t) \exp \left( 4 \pi^2 \left| \underline{k} \right|^2 t \right),
\end{equation}
and write
\begin{equation}
	S_{\underline{k}} (t) = \sum\limits_{n \in \N} \quad S_{n, \underline{k}} t^n.
\end{equation}
Then, in terms of the $S_{n, \underline{k}}$ coefficients, \cref{eq:iteration_torus} becomes
\begin{equation}
	S_{n + 1, \underline{k}} = \frac{1}{n + 1} \sum\limits_{\underline{l} \in \Z^2 - \left\{ \underline{0}, \underline{k} \right\}} \tfrac{\underline{k} \cdot \underline{l}}{\left| \underline{l} \right|^2} \sum\limits_{a = 0}^n \sum\limits_{b = 0}^{n - a} S_{a, \underline{l}} S_{b, \underline{k} - \underline{l}} \frac{\left( 8 \pi^2 \left( \underline{k} - \underline{l} \right) \cdot \underline{l} \right)^{n - a - b}}{(n - a - b)!}. \label{eq:S_iteration_torus}
\end{equation}

If that the coefficients in \cref{eq:iteration_torus} exist after the $n^{\textnormal{th}}$ step, then let
\begin{equation}
	Z_n \eqdef \left\{ \ \underline{k} \in \Z^2 \ \middle| \ S_{n, \underline{k}} \neq 0 \ \right\} \subseteq \Z^2.
\end{equation}

\begin{lemma}
	\label{lemma:finiteness}
	Let us assume that $Z_0$ is finite and symmetric, that is $- Z_0 = Z_0$, and let
	\begin{equation}
		d \eqdef \max \left( \left\{ \ \left| \underline{k} \right| \ \middle| \ \underline{k} \in Z_0 \ \right\} \right) > 0.
	\end{equation}
	Then for all $n \in \N_+$, the coefficients in \cref{eq:iteration_torus} exist and $Z_n$ is finite and symmetric, moreover
	\begin{equation}
		Z_n \subseteq Z_{n - 1} + Z_{n - 1},
	\end{equation}
	and
	\begin{equation}
		\max \left( \left\{ \ \left| \underline{k} \right| \ \middle| \ \underline{k} \in Z_n \ \right\} \right) = \max \left( \left\{ \ \left| \underline{k} \right| \ \middle| \ S_{n, \underline{k}} \neq 0 \ \right\} \right) \leqslant 2^n d.
	\end{equation}
\end{lemma}

\begin{proof}
	*Insert Adam's proof here.*
\end{proof}

For all $\underline{k} \in \Z^2 - \left\{ \underline{0} \right\}$ let
\begin{equation}
	N \left( \underline{k} \right) \eqdef \min \left( \left\{ \ n \in \N \ \middle| \ \underline{k} \in Z_n \ \right\} \right).
\end{equation}

\smallskip

\begin{lemma}
	Under the assumptions above, we have that
	\begin{equation}
		\forall \underline{k} \in \Z^2 - \left\{ \underline{0} \right\} : \forall n \in \N : \quad \left| S_{n, \underline{k}} \right| < \epsilon^n. \label[ineq]{ineq:S_bound}
	\end{equation}
\end{lemma}

\begin{proof}
	By \Cref{lemma:finiteness}, we can rewrite \cref{eq:S_iteration_torus} as
	\begin{equation}
		S_{n + 1, \underline{k}} = \frac{1}{n + 1} \sum\limits_{x = 0}^n \sum\limits_{\underline{l} : N \left( \underline{k} \right) = x} \frac{\underline{k} \cdot \underline{l}}{\left| \underline{l} \right|^2} \sum\limits_{a = x}^n \sum\limits_{b = 0}^{n - a} S_{a, \underline{l}} S_{b, \underline{k} - \underline{l}} \frac{\left( 8 \pi^2 \left( \underline{k} - \underline{l} \right) \cdot \underline{l} \right)^{n - a - b}}{(n - a - b)!}. \label{eq:S_iteration_torus_new}
	\end{equation}

	The \cref{ineq:S_bound} is true for $n = 0$, so we can argue by induction.

	Let us assume now that we have proved \cref{ineq:S_bound} for every nonnegative integer up to $n \in \N$. Without any loss of generality, we can assume that $n > N \left( \underline{k} \right)$, then \cref{ineq:S_bound} holds. Now using \cref{eq:S_iteration_torus_new} we have:
	\begin{align}
		\left| S_{n + 1, \underline{k}} \right|	&\leqslant \frac{1}{n + 1} \sum\limits_{x = 0}^n \sum\limits_{\underline{l} : N \left( \underline{l} \right) = x} \sum\limits_{a = x}^n \sum\limits_{b = 0}^{n - a} \epsilon^{a + b} \frac{\left| 8 \pi^2 \left( \underline{k} - \underline{l} \right) \cdot \underline{l} \right|^{n - a - b}}{(n - a - b)!} \frac{|\underline{k} \cdot \underline{l}|}{\left| \underline{l} \right|^2} \\
		&\leqslant \frac{\epsilon^n}{n + 1} \sum\limits_{x = 0}^n \sum\limits_{\underline{l} : N \left( \underline{l} \right) = x} \sum\limits_{a = 0}^{n - x} a \frac{\left| 8 \pi^2 \left( \underline{k} - \underline{l} \right) \cdot \underline{l} / \epsilon \right|^{n - x - a}}{(n - x - a)!} \frac{|\underline{k} \cdot \underline{l}|}{\left| \underline{l} \right|^2} \\
		&\leqslant \frac{\epsilon^n}{n + 1} \sum\limits_{x = 0}^n \sum\limits_{\underline{l} : N \left( \underline{l} \right) = x} \sum\limits_{a = 0}^{n - x} (n - x - a) \frac{\left| 8 \pi^2 \left( \underline{k} - \underline{l} \right) \cdot \underline{l} / \epsilon \right|^a}{a!} \frac{|\underline{k} \cdot \underline{l}|}{\left| \underline{l} \right|^2} \\
		&\leqslant \frac{\epsilon^n}{n + 1} \sum\limits_{x = 0}^n \sum\limits_{a = 0}^{n - x} (n - x - a) \sum\limits_{\underline{l} : N \left( \underline{l} \right) = x} \frac{\left| 8 \pi^2 \left( \underline{k} - \underline{l} \right) \cdot \underline{l} / \epsilon \right|^a}{a!} \frac{|\underline{k} \cdot \underline{l}|}{\left| \underline{l} \right|^2}
	\end{align}
	Thus
	\begin{align}
		\left| \sum\limits_{m = 0}^n \sum\limits_{\substack{\underline{l} \in Z_m \\ \underline{k} - \underline{l} \in Z_{n - m}}} \tfrac{1}{n + 1} R_{m, \underline{l}} R_{n - m, \underline{k} - \underline{l}} \right|	&\leqslant \sum\limits_{m = 0}^n \frac{C^{n + 2}}{(n + 1)!} \exp \left( - \tfrac{\left| \underline{k} \right|}{C} \right) \binom{n}{m} 2 \pi 4^m 4^{n \ln (n)} \\
		&\leqslant \frac{C^{n + 2}}{(n + 1)!} \exp \left( - \tfrac{\left| \underline{k} \right|}{C} \right) 4^{n \ln (n)} \sum\limits_{m = 0}^n \binom{n}{m} 2 \pi 4^m \\
		&= \frac{C^{n + 2}}{(n + 1)!} \exp \left( - \tfrac{\left| \underline{k} \right|}{C} \right) 4^{n \ln (n)} 2 \pi \frac{5^{n + 1} - 1}{5 - 1}.
	\end{align}
	Inserting this to the outer sum, we get
	\begin{align}
		\left| \sum\limits_{\underline{l} \in \Z^2 - \left\{ \underline{0}, \underline{k} \right\}} \tfrac{\underline{k} \cdot \underline{l}}{\left| \underline{l} \right|^2} \sum\limits_{m = 0}^n \tfrac{1}{n + 1} R_{m, \underline{l}} R_{n - m, \underline{k} - \underline{l}} \right|	&\leqslant \frac{C^{n + 2}}{(n + 1)!} \exp \left( - \tfrac{\left| \underline{k} \right|^2}{C} \right) \sum\limits_{\underline{l} \in \Z^2 - \left\{ \underline{0} \right\}} \tfrac{\left| \underline{k} \cdot \underline{l} \right|}{\left| \underline{l} \right|^2} \left( \left| \underline{l} \right|^2 + \left| \underline{k} - \underline{l} \right|^2 \right)^n \exp \left( \tfrac{2 \left( \underline{k} - \underline{l} \right) \cdot \underline{l}}{C} \right)
	\end{align}
\end{proof}

%===============================================================================
%\bibliography{references}
%===============================================================================

\end{document}
